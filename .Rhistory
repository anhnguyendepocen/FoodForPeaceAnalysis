p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'white',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray80") +
scale_fill_distiller(palette="GnBu", direction = -1)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'white',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray80") +
scale_fill_distiller(palette="GnBu", trans = "reverse")
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'white',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray80") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse")
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'white',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray20") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse")
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'white',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse")
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'white',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray10',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p1 <- d_freq %>% group_by(moYear) %>% summarise(count = mean(monthlyCount)) %>%
ggplot(aes(moYear, y = count)) + geom_bar(stat = "identity") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
geom_vline(data=key.events, colour = "gray80", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight(base_size = 8)
p1
p1 <- d_freq %>% group_by(moYear) %>% summarise(count = mean(monthlyCount)) %>%
ggplot(aes(moYear, y = count)) + geom_bar(stat = "identity", aes(colour = "gray40")) +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
geom_vline(data=key.events, colour = "gray80", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight(base_size = 8)
p1
p1 <- d_freq %>% group_by(moYear) %>% summarise(count = mean(monthlyCount)) %>%
ggplot(aes(moYear, y = count)) + geom_bar(stat = "identity") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
geom_vline(data=key.events, colour = "gray80", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight(base_size = 8)
p1
plotfreq <- plot_grid(p1, p2, align = "v", ncol = 1, rel_heights=c(1,3))
plotfreq
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="Greens", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(count, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
p3 <- d_freq %>% group_by(moYear) %>%
summarise(totValue = sum(value)) %>%
ggplot(aes(moYear, totValue)) + geom_bar(stat = "identity") +
#scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
xlab("")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight()
p3
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="Greens", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(count, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
summary(d_freq$value)
View(d_freq)
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="Greens", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
histogram(d_freq$value)
hist(d_freq$value)
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="Greens", n = 6, trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="Greens", n = 3, trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
?colorRamp(
)\
?colorRamp()
my_pal <- colorRampPalette(c("#ADDD8E", "#004529"), asp = 1)
my_pal <- colorRampPalette(c("#ADDD8E", "#004529"))
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette=my_pal, trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette=my_pal)  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="Greens", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="YlGn", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 1)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
names(d)
d_freq = d %>% group_by(category, moYear, totCount, monthlyCount, sortValue) %>%
summarise(count = n(), value = sum(povalue)/1000000, mean_value = mean(po_unitcost)) %>%
arrange(category, -count)
View(d_freq)
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = mean_value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="YlGn", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(mean_value, 0)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
# Order the commodities by total count variable for graphing
key.events <- data.frame(date=as.Date(c("2011-10-15","2012-10-15","2013-10-15",
"2014-10-15", "2015-10-15", "2016-10-15")))
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
p1 <- d_freq %>% group_by(moYear) %>% summarise(count = mean(monthlyCount)) %>%
ggplot(aes(moYear, y = count)) + geom_bar(stat = "identity") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
geom_vline(data=key.events, colour = "gray80", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight(base_size = 8)
p1
plotfreq <- plot_grid(p1, p2, align = "v", ncol = 1, rel_heights=c(1,3))
plotfreq
ggsave("~/GitHub/FoodForPeaceAnalysis/Graphics/freq.pdf", width = 11, height = 5,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="YlGn", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 2)), size = 2.5, colour = "gray80") +
theme_fivethirtyeight()
p4
p3 <- d_freq %>% group_by(moYear) %>%
summarise(totValue = sum(value)) %>%
ggplot(aes(moYear, totValue)) + geom_bar(stat = "identity") +
#scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
xlab("")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight()
p3
plotvalue <- plot_grid(p3, p4, align = "v", ncol = 1, rel_heights=c(1,3))
plotvalue
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="YlGn", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 2)), size = 1.5, colour = "gray40") +
theme_fivethirtyeight()
p4
# Melt data down into 2 columns, one for value and one for date
p3 <- d_freq %>% group_by(moYear) %>%
summarise(totValue = sum(value)) %>%
ggplot(aes(moYear, totValue)) + geom_bar(stat = "identity") +
#scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
xlab("")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight()
p3
plotvalue <- plot_grid(p3, p4, align = "v", ncol = 1, rel_heights=c(1,3))
plotvalue
p3 <- d_freq %>% group_by(moYear) %>%
summarise(totValue = sum(value)) %>%
ggplot(aes(moYear, totValue)) + geom_bar(stat = "identity") +
#scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
xlab("")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight()
p3
plotvalue <- plot_grid(p3, p4, align = "v", ncol = 1, rel_heights=c(1,3))
plotvalue
p5 <- ggplot(d_freq, aes(moYear, sortValue, fill = mean_value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="YlGn", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(mean_value, 2)), size = 1.5, colour = "gray40") +
theme_fivethirtyeight()
p5
summary(d$po_unitcost)
p2
plotfreq
plotvalue <- plot_grid(p3, p4, align = "v", ncol = 1, rel_heights=c(1,3))
plotvalue
p1 <- d_freq %>% group_by(moYear) %>% summarise(count = mean(monthlyCount)) %>%
ggplot(aes(moYear, y = count)) + geom_bar(stat = "identity") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
geom_vline(data=key.events, colour = "gray80", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_bw(base_size = 8)
p1
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(data = subset(df_freq, !is.na(count)), colour = 'gray80', stat = "identity") +
geom_tile(data = subset(df_freq, is.na(count)), colour = "gray80") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(data = subset(d_freq, !is.na(count)), colour = 'gray80', stat = "identity") +
geom_tile(data = subset(d_freq, is.na(count)), colour = "gray80") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(data = subset(d_freq, !is.na(count)), stat = "identity") +
geom_tile(data = subset(d_freq, is.na(count)), aes(colour = NA),
linetype = 0, fill = "pink", alpha = 0.5) +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(data = subset(d_freq, !is.na(count)), stat = "identity") +
geom_tile(data = subset(d_freq, is.na(count)), aes(colour = NA), fill = "pink", alpha = 0.5) +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(data = subset(d_freq, !is.na(count)), stat = "identity") +
geom_tile(data = subset(d_freq, is.na(count)), fill = "pink", alpha = 0.5) +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(data = subset(d_freq, !is.na(count)), stat = "identity") +
geom_tile(data = subset(d_freq, is.na(count)), stat = "identity")
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "gray80") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.values = "gray80") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity", na.value = NA) +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "gray80") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity", na.value = NA) +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "black") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "black") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_bw(base_size = 8)
p2
View(d_freq)
p2
library(extrafont)
fonttable()
font_import(pattern="[C/c]omic")
font_import(pattern="[S/s]egoe")
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "gray50") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8, family="Segoe UI")
p2
key.events <- data.frame(date=as.Date(c("2011-10-15","2012-10-15","2013-10-15",
"2014-10-15", "2015-10-15", "2016-10-15")))
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "gray50") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
plotfreq <- plot_grid(p1, p2, align = "v", ncol = 1, rel_heights=c(1,3))
plotfreq
p1 <- d_freq %>% group_by(moYear) %>% summarise(count = mean(monthlyCount)) %>%
ggplot(aes(moYear, y = count)) + geom_bar(stat = "identity") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
geom_vline(data=key.events, colour = "gray80", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight(base_size = 8)
p1
plotfreq <- plot_grid(p1, p2, align = "v", ncol = 1, rel_heights=c(1,3))
plotfreq
# Focus on the unit cost average per commodity
p4 <- ggplot(d_freq, aes(moYear, sortValue, fill = value)) +
geom_tile(colour = 'white', size = 0.25, stat = "identity") +
scale_fill_distiller(palette="YlGn", trans = "reverse")  +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
geom_text(aes(y = category, x = moYear, label = round(value, 2)), size = 1.5, colour = "gray40") +
theme_fivethirtyeight()
p4
# Melt data down into 2 columns, one for value and one for date
p3 <- d_freq %>% group_by(moYear) %>%
summarise(totValue = sum(value)) %>%
ggplot(aes(moYear, totValue)) + geom_bar(stat = "identity") +
#scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y") +
xlab("")+
geom_vline(data=key.events, colour = "gray80", size = 1, linetype = "dashed",
aes(xintercept=as.integer(date))) +
theme_fivethirtyeight()
p3
plotvalue <- plot_grid(p3, p4, align = "v", ncol = 1, rel_heights=c(1,3))
plotvalue
"2014-10-15", "2015-10-15", "2016-10-15")))
p2 <- ggplot(d_freq, aes(moYear, category, fill = count)) +
geom_tile(colour = 'gray80',size = 0.25, stat = "identity") +
geom_text(aes(y = category, x = moYear, label = round(count, 0)), size = 2, colour = "gray40") +
scale_fill_distiller(palette="YlGnBu", trans = "reverse", na.value = "gray50") +
scale_x_date(date_breaks = "3 month", date_labels = "%b-%Y")+
geom_vline(data=key.events, colour = "gray100", size = 0.25, linetype = "dashed",
aes(xintercept=as.integer(date))) +
#labs(title = "Peas are the most commonly procured commodity") +
theme_fivethirtyeight(base_size = 8)
p2
